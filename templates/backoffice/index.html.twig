{% extends 'backoffice/base.html.twig' %}

{% block title %}Backoffice Banque Dauphine{% endblock %}

{% block navbar %}
    {% include 'backoffice/navbar_authenticated.html.twig' %}
{% endblock %}

{% block body %}

    {% if app.session.flashbag.peek('success')|length > 0 %}
        <div class="alert alert-warning">
        {% for message in app.flashes('success') %}
            {{ message }}<br />
        {% endfor %}
        </div>
    {% else %}
    {% endif %}

    {% if app.session.flashbag.peek('error')|length > 0 %}
        <div class="alert alert-danger">
        {% for message in app.flashes('error') %}
                {{ message }}
        {% endfor %}
        </div>
    {% else %}
    {% endif %}

<div class="content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="card">

                    <div class="header">
                        <h4 class="title">Ouvertures de compte</h4>
                        <p class="category">Demandes en attente de validation</p>
                        <table id="liste_prospects" class="table table-striped table-bordered" style="width: 100%;">
                            <thead>
                            <tr>
                                <th>Prénom</th>
                                <th>Nom</th>
                                <th>Email</th>
                                <th>Mobile</th>
                                <th></th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for client in clients %}
                                <tr>
                                    <td>{{ client.prenom }}</td>
                                    <td>{{ client.nom }}</td>
                                    <td>{{ client.email }}</td>
                                    <td>{{ client.mobile }}</td>
                                    <td>
                                        <a href="/validateRegistration/{{ client.id }}/KO"><button class="alert alert-danger">Refuser</button></a>
                                        <a href="/validateRegistration/{{ client.id }}/OK"><button class="alert alert-success">Valider</button></a>
                                    </td>
                                </tr>
                            {% endfor %}
                            </tbody>
                            <tfoot>
                            {#<tr>
                                <th>Prénom</th>
                                <th>Nom</th>
                                <th>Email</th>
                                <th>Mobile</th>
                            </tr>#}
                            </tfoot>
                        </table>
                    </div>
                    {#<div class="content">
                        <div class="footer">
                            <div class="legend">
                                <i class="fa fa-circle text-info"></i> En attente
                                <i class="fa fa-circle text-danger"></i> Refusé
                                <i class="fa fa-circle text-warning"></i> Validé
                            </div>
                            <hr>
                            <div class="stats">
                                <i class="fa fa-clock-o"></i> Février 2019
                            </div>
                        </div>
                    </div>#}
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="header">
                        <h4 class="title">Ajout de bénéficiaires</h4>
                        <p class="category">Demandes en attente de validation</p>
                    </div>
                    {#<div class="content">
                        <div id="chartHours" class="ct-chart"></div>
                        <div class="footer">
                            <div class="legend">
                                <i class="fa fa-circle text-info"></i> En attente
                                <i class="fa fa-circle text-danger"></i> Refusé
                                <i class="fa fa-circle text-warning"></i> Validé
                            </div>
                            <hr>
                            <div class="stats">
                                <i class="fa fa-history"></i> Mis à jour il y a 3 minutes
                            </div>
                        </div>
                    </div>#}
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="card ">
                    <div class="header">
                        <h4 class="title">Demandes de chéquier</h4>
                        <p class="category">En attente de validation</p>
                    </div>
                    {#<div class="content">
                        <div id="chartActivity" class="ct-chart"></div>

                        <div class="footer">
                            <div class="legend">
                                <i class="fa fa-circle text-info"></i> Validé
                                <i class="fa fa-circle text-danger"></i> Refusé
                            </div>
                            <hr>
                            <div class="stats">
                                <i class="fa fa-check"></i> Données validées
                            </div>
                        </div>
                    </div>#}
                </div>
            </div>
        </div>

         <div class="row">
            <div class="col-md-12">
                <div class="card ">
                    <div class="header">
                        <h4 class="title">Demandes de carte bancaire</h4>
                        <p class="category">En attente de validation</p>
                    </div>
                </div>
            </div>
         </div>
    </div>
</div>

    <script>

        $('#liste_prospects').DataTable({
            "language": {
                "url": "//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/French.json"
            }
            ,"dom": '<"top"if>rt<"bottom"lp><"clear">'
        });

        /*var detailRows = [];
        $('#liste_prospects tbody').on( 'click', 'tr td.details-control', function () {
            var tr = $(this).closest('tr');
            var row = dt.row( tr );
            var idx = $.inArray( tr.attr('id'), detailRows );

            if ( row.child.isShown() ) {
                tr.removeClass( 'details' );
                row.child.hide();

                // Remove from the 'open' array
                detailRows.splice( idx, 1 );
            }
            else {
                tr.addClass( 'details' );
                row.child( format( row.data() ) ).show();

                // Add to the 'open' array
                if ( idx === -1 ) {
                    detailRows.push( tr.attr('id') );
                }
            }
        } );*/

        // On each draw, loop over the `detailRows` array and show any child rows
        /*dt.on( 'draw', function () {
            $.each( detailRows, function ( i, id ) {
                $('#'+id+' td.details-control').trigger( 'click' );
            } );
        } );*/

/*        $('#example').DataTable( {
            data: data,
            columns: [
                { data: 'name' },
                { data: 'position' },
                { data: 'salary' },
                { data: 'office' }
            ]
        } );*/
    </script>
{% endblock %}
